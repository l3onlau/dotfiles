# mpv.conf - Optimized for Intel 12400F + GTX 1660 Ti + 1080p 240Hz
# High cache for online streaming, default 2x speed, fullscreen, English audio/sub
# Shaders from igv's gists (place them in ~/.config/mpv/shaders/)

# ======================
# Misc
# ======================
reset-on-next-file=speed,sub-delay,audio-delay,volume
keep-open=yes
osd-level=0
cursor-autohide=1000
user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0"

# ======================
# General & Performance
# ======================
vo=gpu-next
gpu-api=vulkan
hwdec=nvdec
vulkan-async-compute=yes
vulkan-async-transfer=yes
vd-lavc-dr=yes
framedrop=no
video-sync=display-resample
interpolation=yes
tscale=oversample
profile=high-quality

# ======================
# Cache (large for online video)
# ======================
cache=yes
cache-pause=no
cache-pause-initial=yes
demuxer-max-bytes=2GiB      # 2 GB forward cache
demuxer-max-back-bytes=512MiB  # 500 MB backward cache

# ======================
# Default behavior
# ======================
fs=yes                  # Start fullscreen
speed=2.0               # Default playback speed 2x
alang=eng,en            # Prefer English audio
slang=eng,en            # Prefer English subtitles
sub-auto=fuzzy          # Auto-load external subs

# ======================
# Video quality
# ======================
deband=yes
sigmoid-upscaling=yes
dither-depth=auto

# Scalers
scale=ewa_lanczossharp
cscale=ewa_lanczossharp
dscale=mitchell

# ======================
# Profiles
# ======================
# Low-res content (≤720p) - aggressive upscaling
[low-res]
profile-cond=(height <= 720)
profile-restore=copy
glsl-shaders-clr
glsl-shaders-append="~~/shaders/FSRCNNX_x2_8-0-4-1.glsl"
glsl-shaders-append="~~/shaders/KrigBilateral.glsl"
glsl-shaders-append="~~/shaders/SSimSuperRes.glsl"
glsl-shaders-append="~~/shaders/adaptive-sharpen.glsl"

# Mid-res content (>720p and ≤1080p) - minor enhancement/sharpening
[mid-res]
profile-cond=(height > 720) and (height <= 1080)
profile-restore=copy
glsl-shaders-clr
glsl-shaders-append="~~/shaders/KrigBilateral.glsl"
glsl-shaders-append="~~/shaders/SSimSuperRes.glsl"
glsl-shaders-append="~~/shaders/adaptive-sharpen.glsl"

# High-res content (>1080p) - better downscaling
[high-res]
profile-cond=(height > 1080)
profile-restore=copy
dscale=mitchell
glsl-shaders-clr
glsl-shaders-append="~~/shaders/SSimDownscaler.glsl"

# Interlaced content
[deinterlace]
profile-cond=p["video-params/primaries"] == "bt.601" or p["video-params/primaries"] == "bt.709" and p["video-params/interlacing"]
vf=bwdif

# ======================
# Audio
# ======================
audio-file-auto=fuzzy
audio-pitch-correction=yes
volume-max=200

# ======================
# Subtitles
# ======================
sub-font="Arial"
sub-font-size=55
sub-bold=yes
sub-border-size=3.5
sub-border-color="#000000"
sub-shadow-offset=1
sub-shadow-color="#000000"
sub-color="#FFFFFF"

###################################
# Protocol Specific Configuration #
###################################
[protocol.http]
hls-bitrate=max # use max quality for HLS streams

[protocol.https]
profile=protocol.http

[protocol.ytdl]
profile=protocol.http
